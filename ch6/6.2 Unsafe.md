# Unsafe Rust

这是一个严肃，重大，复杂和危险的话题。这是如此严重，以至于我写[了另一本书](https://doc.rust-lang.org/nightly/nomicon/)。

总而言之，*每当*允许调用其他语言时，*每种*语言实际上都是不安全的，因为您可以让C任意做坏事。是的：Java，Python，Ruby，Haskell ...面对外部功能接口（FFI）每个都非常不安全。

Rust通过将自己分为两种语言来拥抱这个真理：Safe Rust和Unsafe Rust。到目前为止，我们仅与Safe Rust合作。它完全是100％安全的...除非进入FFI或Unsafe Rust。

Unsafe Rust是Safe Rust的超集，它的所有语义和规则都与Safe Rust完全相同，只允许你做一些额外极度不安全的事情，会导致可怕的困扰C的未定义行为。

同样，这是一个非常大的话题，有很多有趣的极端案例。我*真的*不想深入了解它（嗯，我知道。我做到了。[读那本书](https://doc.rust-lang.org/nightly/nomicon/)）。没关系，因为使用链接链表，我们实际上可以忽略几乎所有内容。

我们将主要使用的不安全工具是*裸指针*。裸指针是基本上是C的指针。它们没有别名规则。他们没有生命周期。它们可以为空。它们可以悬垂着。他们可以指出未初始化的内存。它们可以与整数进行转换。它们可以被转化指向另一种类型。可变性？转化。几乎每件事都会发生，这意味着几乎任何事情都可能出错。

这是一些不好的东西，说实话，你不必碰触这些东西将过上更幸福的生活。不幸的是，我们想编写链表，而链表却很糟糕。 这意味着我们将不得不使用不安全的指针。

有两种原始指针：`*const T`和`*mut  T`。它们应该是来自C的“const T*”和“T*”，但是我们真的不关心C认为它们有多重要。只能将`*const T`解引用为`&T`，但与变量的易变性非常相似，这只是针对不正确用法的一个限制。最多也就是说你必须先把`*const`转换成`*mut`。虽然如果你没有修改指针引用的权限，你会很不开心的。

不管怎样，我们在编写代码时会对此有更好的感觉。就目前而言，`*mut T==&uncheck mut T`！

[nom]: https://doc.rust-lang.org/nightly/nomicon/

